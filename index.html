<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>EthOS Logo Memory Game</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    body { 
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; 
      background: linear-gradient(135deg, #667eea 0%, #764ba2 25%, #f093fb 50%, #f5576c 75%, #4facfe 100%);
      background-size: 400% 400%;
      animation: gradientShift 8s ease infinite;
      color: #fff; 
      text-align: center;
      min-height: 100vh;
      padding: 20px;
      position: relative;
      overflow-x: hidden;
    }
    
    body::before {
      content: 'EthOS';
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%) rotate(-15deg);
      font-size: 15vw;
      font-weight: 900;
      color: rgba(255, 255, 255, 0.03);
      z-index: 0;
      pointer-events: none;
      user-select: none;
      font-family: 'Arial Black', sans-serif;
      letter-spacing: 0.1em;
    }
    
    /* Left and Right Watermark Logos */
    body::after {
      content: '';
      position: fixed;
      left: 20px;
      top: 50%;
      transform: translateY(-50%);
      width: 120px;
      height: 60px;
      background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 400 200"><text x="50%" y="60%" text-anchor="middle" dominant-baseline="middle" font-family="Arial Black, sans-serif" font-size="60" font-weight="900"><tspan fill="%23000">Eth</tspan><tspan fill="%236B9EFF">OS</tspan></text></svg>');
      background-size: contain;
      background-repeat: no-repeat;
      background-position: center;
      opacity: 0.1;
      z-index: 0;
      pointer-events: none;
      user-select: none;
    }
    
    .watermark-right {
      position: fixed;
      right: 20px;
      top: 50%;
      transform: translateY(-50%);
      width: 120px;
      height: 60px;
      background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 400 200"><text x="50%" y="60%" text-anchor="middle" dominant-baseline="middle" font-family="Arial Black, sans-serif" font-size="60" font-weight="900"><tspan fill="%23000">Eth</tspan><tspan fill="%236B9EFF">OS</tspan></text></svg>');
      background-size: contain;
      background-repeat: no-repeat;
      background-position: center;
      opacity: 0.1;
      z-index: 0;
      pointer-events: none;
      user-select: none;
      animation: float 6s ease-in-out infinite;
    }
    
    @keyframes float {
      0%, 100% { transform: translateY(-50%) translateX(0); }
      50% { transform: translateY(-50%) translateX(-10px); }
    }
    
    @keyframes gradientShift {
      0%, 100% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
    }
    
    .game-wrapper {
      background: rgba(255, 255, 255, 0.1);
      backdrop-filter: blur(20px);
      border: 1px solid rgba(255, 255, 255, 0.2);
      border-radius: 24px;
      padding: 40px;
      box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
      max-width: 500px;
      width: 100%;
      position: relative;
      z-index: 1;
      margin: 50px auto;
    }
    
    h1 { 
      font-size: 2.2em;
      margin-bottom: 20px;
      font-weight: 700;
      text-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);
      background: linear-gradient(45deg, #fff, #f0f8ff);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }
    
    /* Profile Header */
    .profile-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 20px;
      background: rgba(255, 255, 255, 0.1);
      border-radius: 16px;
      padding: 15px;
      border: 1px solid rgba(255, 255, 255, 0.2);
    }
    
    .profile-avatar {
      width: 60px;
      height: 60px;
      border-radius: 50%;
      background: linear-gradient(45deg, #667eea, #764ba2);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1.8em;
      cursor: pointer;
      transition: all 0.3s ease;
      position: relative;
    }
    
    .profile-avatar:hover {
      transform: scale(1.1);
      box-shadow: 0 0 20px rgba(255, 255, 255, 0.3);
    }
    
    .profile-info {
      flex: 1;
      margin-left: 15px;
      text-align: left;
    }
    
    .player-name {
      font-size: 1.2em;
      font-weight: 700;
      margin-bottom: 5px;
    }
    
    .player-rank {
      font-size: 0.9em;
      opacity: 0.8;
      margin-bottom: 8px;
    }
    
    .xp-bar {
      width: 100%;
      height: 8px;
      background: rgba(255, 255, 255, 0.2);
      border-radius: 4px;
      overflow: hidden;
      position: relative;
    }
    
    .xp-fill {
      height: 100%;
      background: linear-gradient(90deg, #00ff88, #00bfff);
      border-radius: 4px;
      transition: width 0.5s ease;
      position: relative;
    }
    
    .xp-text {
      font-size: 0.7em;
      margin-top: 2px;
      opacity: 0.7;
    }
    
    .rank-badge {
      background: linear-gradient(45deg, #cd7f32, #ffd700);
      color: #333;
      padding: 8px 12px;
      border-radius: 20px;
      font-size: 0.9em;
      font-weight: 700;
      border: 2px solid rgba(255, 255, 255, 0.3);
      text-shadow: none;
    }
    
    .rank-badge.bronze { background: linear-gradient(45deg, #cd7f32, #d4af37); }
    .rank-badge.silver { background: linear-gradient(45deg, #c0c0c0, #e6e6e6); }
    .rank-badge.gold { background: linear-gradient(45deg, #ffd700, #ffed4e); }
    .rank-badge.diamond { background: linear-gradient(45deg, #b9f2ff, #87ceeb); }
    .rank-badge.master { background: linear-gradient(45deg, #9400d3, #ff1493); color: #fff; }
    
    /* Tab Navigation */
    .tab-nav {
      display: flex;
      margin-bottom: 20px;
      background: rgba(255, 255, 255, 0.1);
      border-radius: 12px;
      padding: 4px;
      border: 1px solid rgba(255, 255, 255, 0.2);
    }
    
    .tab-btn {
      flex: 1;
      padding: 12px;
      border: none;
      background: transparent;
      color: rgba(255, 255, 255, 0.7);
      font-size: 0.9em;
      font-weight: 600;
      cursor: pointer;
      border-radius: 8px;
      transition: all 0.3s ease;
    }
    
    .tab-btn.active {
      background: rgba(255, 255, 255, 0.2);
      color: #fff;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
    }
    
    .tab-btn:hover:not(.active) {
      background: rgba(255, 255, 255, 0.1);
      color: rgba(255, 255, 255, 0.9);
    }
    
    .tab-content {
      display: none;
    }
    
    .tab-content.active {
      display: block;
    }
    
    /* Score Panel */
    .score-panel {
      display: flex;
      justify-content: space-between;
      margin-bottom: 20px;
      gap: 15px;
    }
    
    .score-item {
      background: rgba(255, 255, 255, 0.15);
      backdrop-filter: blur(10px);
      border: 1px solid rgba(255, 255, 255, 0.3);
      border-radius: 12px;
      padding: 10px 15px;
      flex: 1;
      transition: all 0.3s ease;
    }
    
    .score-item:hover {
      background: rgba(255, 255, 255, 0.2);
      transform: translateY(-2px);
    }
    
    .score-label {
      font-size: 0.8em;
      opacity: 0.8;
      margin-bottom: 5px;
    }
    
    .score-value {
      font-size: 1.2em;
      font-weight: 700;
      color: #fff;
    }
    
    .score-item.current .score-value {
      color: #00ff88;
      text-shadow: 0 0 10px rgba(0, 255, 136, 0.5);
    }
    
    .score-item.best .score-value {
      color: #ffd700;
      text-shadow: 0 0 10px rgba(255, 215, 0, 0.5);
    }
    
    /* Achievement Panel */
    .achievement-panel {
      background: rgba(255, 255, 255, 0.1);
      border: 1px solid rgba(255, 255, 255, 0.2);
      border-radius: 12px;
      padding: 15px;
      margin-bottom: 20px;
      text-align: left;
    }
    
    .achievement-title {
      font-size: 1em;
      font-weight: 600;
      margin-bottom: 10px;
      text-align: center;
      color: #ffd700;
    }
    
    .achievement-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(60px, 1fr));
      gap: 12px;
    }
    
    .achievement-item {
      width: 60px;
      height: 60px;
      border-radius: 12px;
      display: flex;
      align-items: center;
      justify-content: center;
      flex-direction: column;
      font-size: 1.5em;
      transition: all 0.3s ease;
      cursor: pointer;
      position: relative;
      text-align: center;
    }
    
    .achievement-item.unlocked.bronze {
      background: linear-gradient(45deg, #cd7f32, #d4af37);
      color: #fff;
      box-shadow: 0 0 15px rgba(205, 127, 50, 0.5);
      animation: achievementGlow 2s infinite alternate;
    }
    
    .achievement-item.unlocked.silver {
      background: linear-gradient(45deg, #c0c0c0, #e6e6e6);
      color: #333;
      box-shadow: 0 0 15px rgba(192, 192, 192, 0.5);
      animation: achievementGlow 2s infinite alternate;
    }
    
    .achievement-item.unlocked.gold {
      background: linear-gradient(45deg, #ffd700, #ffed4e);
      color: #333;
      box-shadow: 0 0 15px rgba(255, 215, 0, 0.5);
      animation: achievementGlow 2s infinite alternate;
    }
    
    .achievement-item.locked {
      background: rgba(255, 255, 255, 0.1);
      color: rgba(255, 255, 255, 0.3);
      border: 1px solid rgba(255, 255, 255, 0.2);
    }
    
    .achievement-item:hover {
      transform: scale(1.1);
    }
    
    .achievement-tier {
      font-size: 0.5em;
      margin-top: 2px;
      font-weight: 600;
    }
    
    .achievement-tooltip {
      position: absolute;
      bottom: 65px;
      left: 50%;
      transform: translateX(-50%);
      background: rgba(0, 0, 0, 0.9);
      color: #fff;
      padding: 8px 12px;
      border-radius: 8px;
      font-size: 0.7em;
      white-space: nowrap;
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.3s ease;
      z-index: 100;
      text-align: center;
      min-width: 120px;
    }
    
    .achievement-item:hover .achievement-tooltip {
      opacity: 1;
    }
    
    @keyframes achievementGlow {
      0% { box-shadow: 0 0 15px rgba(255, 215, 0, 0.5); }
      100% { box-shadow: 0 0 25px rgba(255, 215, 0, 0.8); }
    }
    
    /* Performance Graph */
    .performance-graph {
      background: rgba(255, 255, 255, 0.1);
      border: 1px solid rgba(255, 255, 255, 0.2);
      border-radius: 12px;
      padding: 20px;
      margin-bottom: 20px;
      height: 250px;
      position: relative;
    }
    
    .graph-title {
      font-size: 1.1em;
      font-weight: 600;
      margin-bottom: 15px;
      text-align: center;
    }
    
    .graph-container {
      position: relative;
      height: 180px;
      margin: 10px 0;
    }
    
    .graph-line {
      position: absolute;
      bottom: 0;
      left: 0;
      right: 0;
      height: 100%;
    }
    
    .graph-point {
      position: absolute;
      width: 8px;
      height: 8px;
      background: #00ff88;
      border-radius: 50%;
      transform: translate(-50%, 50%);
      transition: all 0.3s ease;
      cursor: pointer;
    }
    
    .graph-point:hover {
      transform: translate(-50%, 50%) scale(1.5);
      box-shadow: 0 0 10px rgba(0, 255, 136, 0.5);
    }
    
    /* Button Heatmap */
    .button-heatmap {
      background: rgba(255, 255, 255, 0.1);
      border: 1px solid rgba(255, 255, 255, 0.2);
      border-radius: 12px;
      padding: 20px;
      margin-bottom: 20px;
    }
    
    .heatmap-title {
      font-size: 1.1em;
      font-weight: 600;
      margin-bottom: 15px;
      text-align: center;
    }
    
    .heatmap-grid {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 15px;
      max-width: 200px;
      margin: 0 auto;
    }
    
    .heatmap-button {
      width: 80px;
      height: 80px;
      border-radius: 12px;
      display: flex;
      align-items: center;
      justify-content: center;
      flex-direction: column;
      font-size: 0.8em;
      font-weight: 600;
      transition: all 0.3s ease;
      border: 2px solid rgba(255, 255, 255, 0.3);
    }
    
    .heatmap-button.low { background: rgba(0, 255, 136, 0.3); }
    .heatmap-button.medium { background: rgba(255, 193, 7, 0.5); }
    .heatmap-button.high { background: rgba(255, 107, 107, 0.7); }
    
    .heatmap-count {
      font-size: 1.2em;
      margin-bottom: 4px;
    }
    
    /* Session History */
    .session-history {
      background: rgba(255, 255, 255, 0.1);
      border: 1px solid rgba(255, 255, 255, 0.2);
      border-radius: 12px;
      padding: 20px;
      margin-bottom: 20px;
      max-height: 300px;
      overflow-y: auto;
    }
    
    .history-title {
      font-size: 1.1em;
      font-weight: 600;
      margin-bottom: 15px;
      text-align: center;
    }
    
    .session-item {
      background: rgba(255, 255, 255, 0.05);
      border: 1px solid rgba(255, 255, 255, 0.1);
      border-radius: 8px;
      padding: 12px;
      margin-bottom: 8px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      font-size: 0.9em;
    }
    
    .session-info {
      display: flex;
      flex-direction: column;
      align-items: flex-start;
    }
    
    .session-score {
      font-weight: 600;
      color: #00ff88;
    }
    
    .session-details {
      font-size: 0.8em;
      opacity: 0.7;
      margin-top: 2px;
    }
    
    .session-time {
      font-size: 0.8em;
      opacity: 0.6;
    }
    
    /* Stats Panel */
    .stats-panel {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 10px;
      margin-bottom: 20px;
    }
    
    .stat-item {
      background: rgba(255, 255, 255, 0.1);
      border: 1px solid rgba(255, 255, 255, 0.2);
      border-radius: 8px;
      padding: 8px;
      font-size: 0.9em;
    }
    
    .stat-label {
      opacity: 0.8;
      font-size: 0.8em;
    }
    
    .stat-value {
      font-weight: 600;
      color: #00bfff;
    }
    
    #game-container {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 20px;
      margin: 30px 0;
      max-width: 320px;
      margin-left: auto;
      margin-right: auto;
    }
    
    .logo-btn {
      width: 140px;
      height: 140px;
      background: rgba(255, 255, 255, 0.15);
      border: 3px solid rgba(255, 255, 255, 0.3);
      border-radius: 24px;
      padding: 12px;
      cursor: pointer;
      outline: none;
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      backdrop-filter: blur(10px);
      position: relative;
      overflow: hidden;
    }
    
    .logo-btn:hover:not(:disabled) {
      transform: translateY(-4px) scale(1.05);
      border-color: rgba(255, 255, 255, 0.6);
      box-shadow: 0 15px 30px rgba(0, 0, 0, 0.2);
    }
    
    .logo-btn:disabled {
      cursor: not-allowed;
      opacity: 0.7;
    }
    
    .logo-btn.active {
      border: 3px solid #fff;
      background: rgba(255, 255, 255, 0.3);
      transform: scale(1.1);
      box-shadow: 0 0 30px rgba(255, 255, 255, 0.5), 0 0 60px rgba(255, 255, 255, 0.3);
      z-index: 2;
    }
    
    .logo-btn.correct {
      border-color: #00ff88;
      background: rgba(0, 255, 136, 0.2);
      animation: correctPulse 0.5s ease;
    }
    
    .logo-btn.wrong {
      border-color: #ff6b6b;
      background: rgba(255, 107, 107, 0.2);
      animation: wrongShake 0.5s ease;
    }
    
    @keyframes correctPulse {
      0%, 100% { transform: scale(1); }
      50% { transform: scale(1.1); }
    }
    
    @keyframes wrongShake {
      0%, 100% { transform: translateX(0); }
      25% { transform: translateX(-5px); }
      75% { transform: translateX(5px); }
    }
    
    .logo-btn::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      border-radius: 21px;
      transition: opacity 0.3s ease;
      opacity: 0;
    }
    
    .logo-btn.color0 img { filter: hue-rotate(0deg) saturate(1.2) brightness(1.1); }
    .logo-btn.color1 img { filter: hue-rotate(120deg) saturate(1.3) brightness(1.1); }
    .logo-btn.color2 img { filter: hue-rotate(240deg) saturate(1.3) brightness(1.1); }
    .logo-btn.color3 img { filter: hue-rotate(300deg) saturate(1.2) brightness(1.1); }
    
    .logo-btn img {
      width: 100%;
      height: 100%;
      object-fit: contain;
      pointer-events: none;
      border-radius: 16px;
      position: relative;
      z-index: 1;
      filter: drop-shadow(0 4px 8px rgba(0, 0, 0, 0.2));
    }
    
    .logo-btn.active img {
      filter: brightness(1.2) drop-shadow(0 8px 16px rgba(0, 0, 0, 0.3));
    }
    
    #controls {
      margin-top: 30px;
      display: flex;
      justify-content: center;
      gap: 15px;
      flex-wrap: wrap;
    }
    
    .game-btn {
      padding: 14px 28px;
      border-radius: 50px;
      border: none;
      background: linear-gradient(45deg, #667eea, #764ba2);
      color: #fff;
      font-size: 1em;
      font-weight: 600;
      cursor: pointer;
      box-shadow: 0 8px 20px rgba(102, 126, 234, 0.3);
      transition: all 0.3s ease;
      position: relative;
      overflow: hidden;
    }
    
    .game-btn::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
      transition: left 0.5s;
    }
    
    .game-btn:hover:not(:disabled)::before {
      left: 100%;
    }
    
    .game-btn:disabled {
      opacity: 0.5;
      cursor: not-allowed;
      transform: none;
    }
    
    .game-btn:hover:not(:disabled) { 
      transform: translateY(-2px);
      box-shadow: 0 12px 30px rgba(102, 126, 234, 0.4);
    }
    
    .game-btn:active:not(:disabled) {
      transform: translateY(0);
    }
    
    #status {
      margin-top: 25px;
      font-size: 1.2em;
      min-height: 60px;
      display: flex;
      align-items: center;
      justify-content: center;
      text-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);
      font-weight: 500;
    }
    
    #code-box {
      background: linear-gradient(45deg, #00c9ff, #92fe9d);
      color: #fff;
      margin: 25px auto 0 auto;
      padding: 20px 32px;
      border-radius: 16px;
      width: fit-content;
      font-size: 1.1em;
      font-weight: 700;
      letter-spacing: 1px;
      box-shadow: 0 8px 30px rgba(0, 201, 255, 0.3);
      text-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
      animation: pulse 2s infinite;
    }
    
    @keyframes pulse {
      0%, 100% { transform: scale(1); }
      50% { transform: scale(1.05); }
    }
    
    #code-box span {
      display: block;
      font-size: 1.4em;
      margin-top: 8px;
      letter-spacing: 3px;
      font-family: 'Courier New', monospace;
    }
    
    .level-indicator {
      display: inline-block;
      background: rgba(255, 255, 255, 0.2);
      padding: 8px 16px;
      border-radius: 20px;
      margin: 10px 0;
      backdrop-filter: blur(10px);
      border: 1px solid rgba(255, 255, 255, 0.3);
    }
    
    .popup-overlay {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0, 0, 0, 0.8);
      backdrop-filter: blur(10px);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 1000;
      animation: fadeIn 0.3s ease;
    }
    
    .popup {
      background: linear-gradient(135deg, rgba(255, 255, 255, 0.2), rgba(255, 255, 255, 0.1));
      backdrop-filter: blur(20px);
      border: 2px solid rgba(255, 255, 255, 0.3);
      border-radius: 20px;
      padding: 40px;
      text-align: center;
      max-width: 400px;
      width: 90%;
      transform: scale(0.8);
      animation: popIn 0.4s ease forwards;
    }
    
    .popup.success {
      border-color: rgba(0, 255, 136, 0.5);
      box-shadow: 0 0 30px rgba(0, 255, 136, 0.3);
    }
    
    .popup.failure {
      border-color: rgba(255, 107, 107, 0.5);
      box-shadow: 0 0 30px rgba(255, 107, 107, 0.3);
    }
    
    .popup.achievement {
      border-color: rgba(255, 215, 0, 0.5);
      box-shadow: 0 0 30px rgba(255, 215, 0, 0.3);
    }
    
    .popup h2 {
      font-size: 2.5em;
      margin-bottom: 20px;
      font-weight: 900;
      text-shadow: 0 4px 10px rgba(0, 0, 0, 0.5);
    }
    
    .popup.success h2 {
      color: #00ff88;
      animation: glow 2s ease-in-out infinite alternate;
    }
    
    .popup.failure h2 {
      color: #ff6b6b;
      animation: shake 0.5s ease-in-out;
    }
    
    .popup.achievement h2 {
      color: #ffd700;
      animation: glow 2s ease-in-out infinite alternate;
    }
    
    .popup p {
      font-size: 1.2em;
      margin-bottom: 30px;
      opacity: 0.9;
    }
    
    .popup-btn {
      padding: 15px 30px;
      border-radius: 50px;
      border: none;
      background: linear-gradient(45deg, #667eea, #764ba2);
      color: #fff;
      font-size: 1.1em;
      font-weight: 600;
      cursor: pointer;
      box-shadow: 0 8px 20px rgba(102, 126, 234, 0.3);
      transition: all 0.3s ease;
    }
    
    .popup-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 12px 30px rgba(102, 126, 234, 0.4);
    }
    
    @keyframes fadeIn {
      from { opacity: 0; }
      to { opacity: 1; }
    }
    
    @keyframes popIn {
      from { transform: scale(0.8) translateY(20px); opacity: 0; }
      to { transform: scale(1) translateY(0); opacity: 1; }
    }
    
    @keyframes glow {
      from { text-shadow: 0 4px 10px rgba(0, 0, 0, 0.5), 0 0 20px currentColor; }
      to { text-shadow: 0 4px 10px rgba(0, 0, 0, 0.5), 0 0 30px currentColor; }
    }
    
    @keyframes shake {
      0%, 100% { transform: translateX(0); }
      25% { transform: translateX(-10px); }
      75% { transform: translateX(10px); }
    }

    @media (max-width: 768px) {
      .game-wrapper {
        padding: 30px 20px;
        margin: 10px;
      }
      
      h1 {
        font-size: 1.8em;
      }
      
      .profile-header {
        flex-direction: column;
        text-align: center;
        gap: 15px;
      }
      
      .profile-info {
        margin-left: 0;
        text-align: center;
      }
      
      .score-panel {
        flex-direction: column;
        gap: 10px;
      }
      
      .stats-panel {
        grid-template-columns: 1fr;
      }
      
      .tab-nav {
        flex-wrap: wrap;
      }
      
      .tab-btn {
        min-width: 100px;
      }
      
      #game-container {
        gap: 15px;
        max-width: 280px;
      }
      
      .logo-btn {
        width: 120px;
        height: 120px;
      }
      
      .game-btn {
        padding: 12px 20px;
        font-size: 0.9em;
      }
    }
  </style>
</head>
<body>
  <div class="game-wrapper">
    <h1>EthOS Logo Memory Game</h1>
    
    <!-- Profile Header -->
    <div class="profile-header">
      <div class="profile-avatar" onclick="changeAvatar()" title="Click to change avatar">
        <span id="player-avatar">🎮</span>
      </div>
      <div class="profile-info">
        <div class="player-name" id="player-name">EthOS Player</div>
        <div class="player-rank">
          <span class="rank-badge" id="rank-badge">Bronze</span>
        </div>
        <div class="xp-bar">
          <div class="xp-fill" id="xp-fill" style="width: 0%"></div>
        </div>
        <div class="xp-text" id="xp-text">0 / 100 XP</div>
      </div>
    </div>
    
    <!-- Tab Navigation -->
    <div class="tab-nav">
      <button class="tab-btn active" onclick="switchTab('game')">🎮 Game</button>
      <button class="tab-btn" onclick="switchTab('stats')">📊 Stats</button>
      <button class="tab-btn" onclick="switchTab('achievements')">🏆 Achievements</button>
      <button class="tab-btn" onclick="switchTab('profile')">👤 Profile</button>
    </div>
    
    <!-- Game Tab -->
    <div id="game-tab" class="tab-content active">
      <!-- Score Panel -->
      <div class="score-panel">
        <div class="score-item current">
          <div class="score-label">Current Score</div>
          <div class="score-value" id="current-score">0</div>
        </div>
        <div class="score-item best">
          <div class="score-label">Best Score</div>
          <div class="score-value" id="best-score">0</div>
        </div>
        <div class="score-item">
          <div class="score-label">Win Rate</div>
          <div class="score-value" id="win-rate">0%</div>
        </div>
      </div>
      
      <div id="game-container"></div>
      <div id="controls">
        <button id="start-btn" class="game-btn">🚀 Start Game</button>
        <button id="restart-btn" class="game-btn" disabled>🔄 Restart Level</button>
        <button id="startover-btn" class="game-btn" disabled>🆕 New Game</button>
      </div>
      <div id="status">Press "Start Game" to begin your EthOS journey!</div>
      <div id="code-box" style="display:none;">
        <div>🎉 Congratulations! 🎉</div>
        <span></span>
      </div>
    </div>
    
    <!-- Stats Tab -->
    <div id="stats-tab" class="tab-content">
      <!-- Performance Graph -->
      <div class="performance-graph">
        <div class="graph-title">📈 Performance Over Time</div>
        <div class="graph-container" id="performance-chart">
          <canvas id="performance-canvas" width="400" height="180"></canvas>
        </div>
      </div>
      
      <!-- Button Heatmap -->
      <div class="button-heatmap">
        <div class="heatmap-title">🎯 Button Error Heatmap</div>
        <div class="heatmap-grid">
          <div class="heatmap-button low" id="heatmap-0">
            <div class="heatmap-count">0</div>
            <div>Button 1</div>
          </div>
          <div class="heatmap-button low" id="heatmap-1">
            <div class="heatmap-count">0</div>
            <div>Button 2</div>
          </div>
          <div class="heatmap-button low" id="heatmap-2">
            <div class="heatmap-count">0</div>
            <div>Button 3</div>
          </div>
          <div class="heatmap-button low" id="heatmap-3">
            <div class="heatmap-count">0</div>
            <div>Button 4</div>
          </div>
        </div>
      </div>
      
      <!-- Session History -->
      <div class="session-history">
        <div class="history-title">📝 Recent Sessions</div>
        <div id="session-list">
        </div>
      </div>
      
      <!-- Stats Panel -->
      <div class="stats-panel">
        <div class="stat-item">
          <div class="stat-label">Games Played</div>
          <div class="stat-value" id="games-played">0</div>
        </div>
        <div class="stat-item">
          <div class="stat-label">Games Won</div>
          <div class="stat-value" id="games-won">0</div>
        </div>
        <div class="stat-item">
          <div class="stat-label">Current Streak</div>
          <div class="stat-value" id="current-streak">0</div>
        </div>
        <div class="stat-item">
          <div class="stat-label">Best Streak</div>
          <div class="stat-value" id="best-streak">0</div>
        </div>
        <div class="stat-item">
          <div class="stat-label">Average Score</div>
          <div class="stat-value" id="average-score">0</div>
        </div>
        <div class="stat-item">
          <div class="stat-label">Total XP</div>
          <div class="stat-value" id="total-xp">0</div>
        </div>
        <div class="stat-item">
          <div class="stat-label">Accuracy Rate</div>
          <div class="stat-value" id="accuracy-rate">0%</div>
        </div>
        <div class="stat-item">
          <div class="stat-label">Play Time</div>
          <div class="stat-value" id="total-playtime">0m</div>
        </div>
      </div>
    </div>
    
    <!-- Achievements Tab -->
    <div id="achievements-tab" class="tab-content">
      <div class="achievement-panel">
        <div class="achievement-title">🏆 Achievement Collection</div>
        <div class="achievement-grid" id="achievement-grid"></div>
      </div>
    </div>
    
    <!-- Profile Tab -->
    <div id="profile-tab" class="tab-content">
      <div class="achievement-panel">
        <div class="achievement-title">👤 Player Profile</div>
        <div style="text-align: center; padding: 20px;">
          <div style="margin-bottom: 20px;">
            <label style="display: block; margin-bottom: 10px;">Player Name:</label>
            <input type="text" id="name-input" value="EthOS Player" 
                   style="background: rgba(255,255,255,0.1); border: 1px solid rgba(255,255,255,0.3); 
                          border-radius: 8px; padding: 10px; color: #fff; text-align: center; width: 200px;"
                   onchange="updatePlayerName()">
          </div>
          
          <div style="margin-bottom: 20px;">
            <label style="display: block; margin-bottom: 10px;">Choose Avatar:</label>
            <div style="display: flex; justify-content: center; gap: 10px; flex-wrap: wrap;">
              <div class="profile-avatar" style="width: 50px; height: 50px; font-size: 1.2em;" 
                   onclick="setAvatar('🎮')">🎮</div>
              <div class="profile-avatar" style="width: 50px; height: 50px; font-size: 1.2em;" 
                   onclick="setAvatar('👾')">👾</div>
              <div class="profile-avatar" style="width: 50px; height: 50px; font-size: 1.2em;" 
                   onclick="setAvatar('🤖')">🤖</div>
              <div class="profile-avatar" style="width: 50px; height: 50px; font-size: 1.2em;" 
                   onclick="setAvatar('🚀')">🚀</div>
              <div class="profile-avatar" style="width: 50px; height: 50px; font-size: 1.2em;" 
                   onclick="setAvatar('⚡')">⚡</div>
              <div class="profile-avatar" style="width: 50px; height: 50px; font-size: 1.2em;" 
                   onclick="setAvatar('🔥')">🔥</div>
            </div>
          </div>
          
          <div style="margin-bottom: 20px;">
            <button class="game-btn" onclick="resetAllData()" 
                    style="background: linear-gradient(45deg, #ff6b6b, #ee5a52);">
              🗑️ Reset All Data
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Right Watermark -->
  <div class="watermark-right"></div>

 <audio id="snd-seq" preload="auto">
    <source src="https://www.soundjay.com/misc/sounds/bell-ringing-05.wav" type="audio/wav">
    <source src="data:audio/wav;base64,UklGRnoGAABXQVZFZm10IBAAAAABAAEAQB8AAEAfAAABAAgAZGF0YQoGAACBhYqFbF1fdJivrJBhNjVgodDbq2EcBj+a2/LDciUFLIHO8tiJNwgZaLvt559NEAxQp+PwtmMcBjiR1/LMeSwFJHfH8N2QQAoUXrTp66hVFApGn+n1umMcBjeH0+/Dgz8JGG/B7+CdbBsQasPu7aZdGAg+ltryxnkpBSl+z/DajzMHElyx5+iTQAoFUnTE7d2JSQgNZ7nsy59MEAP85tPoL2D+bHfDm2mzOWLnHGTy+7N4xdX21T8qYPpFJ4y4NJPj3PL7CwHR0ej21fXXkv3lx9frF2T+a2f+LnfDm0W6+pB7/3J4pNDr5+wNGOjl1O3o7+r/8/P3t/Dz7O3///+YqP/1//7V7ezr8Obt6+rw5/Pl6u3j7/cU9lXy+7N4xdX21T8qYPpFJ4y4NJPj3PL7CwEq9Fbz+zN3xLb51D8rY/RHL3jCm0S8+4t7/3J4pNDr5+wNGOjl1O3o7+r/8/P3t/Dz7O3///+YqP/1//7V7ezr8Obt6+rw5/Pl6u3j7/cU9lXy+7N4xdX21T8qYPpFJ4y4NJPj3PL7CwEq9Fbz+zN3xLb51D8rY/RHL3jCm0S8+4t7/3J4pNDr5+wNGOjl1O3o7+r/8/P3t/Dz7O3///+YqP/1//7V7ezr8Obt6+rw5/Pl6u3j7/cU9lXy+7N4xdX21T8qYPpFJ4y4NJPj3PL7CwEq9Fbz+zN3xLb51D8rY/RHL3jCm0S8+4t7/3J4pNDr5+wNGOjl1O3o7+r/8/P3t/Dz7O3///+YqP/1//7V7ezr8Obt6+rw5/Pl6u3j7/c" type="audio/mpeg">
  </audio>
  <audio id="snd-click" preload="auto">
    <source src="https://www.soundjay.com/misc/sounds/beep-07a.wav" type="audio/wav">
    <source src="data:audio/wav;base64,UklGRi4DAABXQVZFZm10IBAAAAABAAEARKwAAIhYAQACABAAZGF0YQoDAAC4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4" type="audio/mpeg">
  </audio>
  <audio id="snd-win" preload="auto">
    <source src="https://www.soundjay.com/misc/sounds/bell-ringing-05.wav" type="audio/wav">
    <source src="data:audio/wav;base64,UklGRnoGAABXQVZFZm10IBAAAAABAAEAQB8AAEAfAAABAAgAZGF0YQoGAACBhYqFbF1fdJivrJBhNjVgodDbq2EcBj+a2/LDciUFLIHO8tiJNwgZaLvt559NEAxQp+PwtmMcBjiR1/LMeSwFJHfH8N2QQAoUXrTp66hVFApGn+n1umMcBjeH0+/Dgz8JGG/B7+CdbBsQasPu7aZdGAg+ltryxnkpBSl+z/DajzMHElyx5+iTQAoFUnTE7d2JSQgNZ7nsy59MEAP85tPoL2D+bHfDm2mzOWLnHGTy+7N4xdX21T8qYPpFJ4y4NJPj3PL7CwHR0ej21fXXkv3lx9frF2T+a2f+LnfDm0W6+pB7/3J4pNDr5+wNGOjl1O3o7+r/8/P3t/Dz7O3///+YqP/1//7V7ezr8Obt6+rw5/Pl6u3j7/cU9lXy+7N4xdX21T8qYPpFJ4y4NJPj3PL7CwEq9Fbz+zN3xLb51D8rY/RHL3jCm0S8+4t7/3J4pNDr5+wNGOjl1O3o7+r/8/P3t/Dz7O3///+YqP/1//7V7ezr8Obt6+rw5/Pl6u3j7/cU9lXy+7N4xdX21T8qYPpFJ4y4NJPj3PL7CwEq9Fbz+zN3xLb51D8rY/RHL3jCm0S8+4t7/3J4pNDr5+wNGOjl1O3o7+r/8/P3t/Dz7O3///+YqP/1//7V7ezr8Obt6+rw5/Pl6u3j7/cU9lXy+7N4xdX21T8qYPpFJ4y4NJPj3PL7CwEq9Fbz+zN3xLb51D8rY/RHL3jCm0S8+4t7/3J4pNDr5+wNGOjl1O3o7+r/8/P3t/Dz7O3///+YqP/1//7V7ezr8Obt6+rw5/Pl6u3j7/c" type="audio/mpeg">
  </audio>
  <audio id="snd-lose" preload="auto">
    <source src="https://www.soundjay.com/misc/sounds/fail-buzzer-02.wav" type="audio/wav">
    <source src="data:audio/wav;base64,UklGRi4DAABXQVZFZm10IBAAAAABAAEARKwAAIhYAQACABAAZGF0YQoDAAC4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4" type="audio/mpeg">
  </audio>
  <audio id="snd-achievement" preload="auto">
    <source src="https://www.soundjay.com/misc/sounds/bell-ringing-05.wav" type="audio/wav">
    <source src="data:audio/wav;base64,UklGRnoGAABXQVZFZm10IBAAAAABAAEAQB8AAEAfAAABAAgAZGF0YQoGAACBhYqFbF1fdJivrJBhNjVgodDbq2EcBj+a2/LDciUFLIHO8tiJNwgZaLvt559NEAxQp+PwtmMcBjiR1/LMeSwFJHfH8N2QQAoUXrTp66hVFApGn+n1umMcBjeH0+/Dgz8JGG/B7+CdbBsQasPu7aZdGAg+ltryxnkpBSl+z/DajzMHElyx5+iTQAoFUnTE7d2JSQgNZ7nsy59MEAP85tPoL2D+bHfDm2mzOWLnHGTy+7N4xdX21T8qYPpFJ4y4NJPj3PL7CwHR0ej21fXXkv3lx9frF2T+a2f+LnfDm0W6+pB7/3J4pNDr5+wNGOjl1O3o7+r/8/P3t/Dz7O3///+YqP/1//7V7ezr8Obt6+rw5/Pl6u3j7/cU9lXy+7N4xdX21T8qYPpFJ4y4NJPj3PL7CwEq9Fbz+zN3xLb51D8rY/RHL3jCm0S8+4t7/3J4pNDr5+wNGOjl1O3o7+r/8/P3t/Dz7O3///+YqP/1//7V7ezr8Obt6+rw5/Pl6u3j7/cU9lXy+7N4xdX21T8qYPpFJ4y4NJPj3PL7CwEq9Fbz+zN3xLb51D8rY/RHL3jCm0S8+4t7/3J4pNDr5+wNGOjl1O3o7+r/8/P3t/Dz7O3///+YqP/1//7V7ezr8Obt6+rw5/Pl6u3j7/cU9lXy+7N4xdX21T8qYPpFJ4y4NJPj3PL7CwEq9Fbz+zN3xLb51D8rY/RHL3jCm0S8+4t7/3J4pNDr5+wNGOjl1O3o7+r/8/P3t/Dz7O3///+YqP/1//7V7ezr8Obt6+rw5/Pl6u3j7/c" type="audio/mpeg">
  </audio>
  <audio id="snd-score" preload="auto">
    <source src="https://www.soundjay.com/misc/sounds/beep-07a.wav" type="audio/wav">
    <source src="data:audio/wav;base64,UklGRi4DAABXQVZFZm10IBAAAAABAAEARKwAAIhYAQACABAAZGF0YQoDAAC4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4" type="audio/mpeg">
  </audio>
  <audio id="snd-level-complete" preload="auto">
    <source src="https://www.soundjay.com/misc/sounds/bell-ringing-05.wav" type="audio/wav">
    <source src="data:audio/wav;base64,UklGRnoGAABXQVZFZm10IBAAAAABAAEAQB8AAEAfAAABAAgAZGF0YQoGAACBhYqFbF1fdJivrJBhNjVgodDbq2EcBj+a2/LDciUFLIHO8tiJNwgZaLvt559NEAxQp+PwtmMcBjiR1/LMeSwFJHfH8N2QQAoUXrTp66hVFApGn+n1umMcBjeH0+/Dgz8JGG/B7+CdbBsQasPu7aZdGAg+ltryxnkpBSl+z/DajzMHElyx5+iTQAoFUnTE7d2JSQgNZ7nsy59MEAP85tPoL2D+bHfDm2mzOWLnHGTy+7N4xdX21T8qYPpFJ4y4NJPj3PL7CwHR0ej21fXXkv3lx9frF2T+a2f+LnfDm0W6+pB7/3J4pNDr5+wNGOjl1O3o7+r/8/P3t/Dz7O3///+YqP/1//7V7ezr8Obt6+rw5/Pl6u3j7/cU9lXy+7N4xdX21T8qYPpFJ4y4NJPj3PL7CwEq9Fbz+zN3xLb51D8rY/RHL3jCm0S8+4t7/3J4pNDr5+wNGOjl1O3o7+r/8/P3t/Dz7O3///+YqP/1//7V7ezr8Obt6+rw5/Pl6u3j7/cU9lXy+7N4xdX21T8qYPpFJ4y4NJPj3PL7CwEq9Fbz+zN3xLb51D8rY/RHL3jCm0S8+4t7/3J4pNDr5+wNGOjl1O3o7+r/8/P3t/Dz7O3///+YqP/1//7V7ezr8Obt6+rw5/Pl6u3j7/cU9lXy+7N4xdX21T8qYPpFJ4y4NJPj3PL7CwEq9Fbz+zN3xLb51D8rY/RHL3jCm0S8+4t7/3J4pNDr5+wNGOjl1O3o7+r/8/P3t/Dz7O3///+YqP/1//7V7ezr8Obt6+rw5/Pl6u3j7/c" type="audio/mpeg">
  </audio>
  <audio id="snd-correct" preload="auto">
    <source src="https://www.soundjay.com/misc/sounds/beep-07a.wav" type="audio/wav">
    <source src="data:audio/wav;base64,UklGRi4DAABXQVZFZm10IBAAAAABAAEARKwAAIhYAQACABAAZGF0YQoDAAC4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4" type="audio/mpeg">
  </audio>
  <audio id="snd-wrong" preload="auto">
    <source src="https://www.soundjay.com/misc/sounds/fail-buzzer-02.wav" type="audio/wav">
    <source src="data:audio/wav;base64,UklGRi4DAABXQVZFZm10IBAAAAABAAEARKwAAIhYAQACABAAZGF0YQoDAAC4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4" type="audio/mpeg">
  </audio><!DOCTYPE html>

  <script>
    const logoSrc = "https://pbs.twimg.com/profile_images/1927690030455341057/pAFgpio-_400x400.jpg";
    const buttonCount = 4;
    const maxLevel = 10;
    const gameContainer = document.getElementById('game-container');
    const statusDiv = document.getElementById('status');
    const startBtn = document.getElementById('start-btn');
    const restartBtn = document.getElementById('restart-btn');
    const startOverBtn = document.getElementById('startover-btn');
    const codeBox = document.getElementById('code-box');
    
    // Score elements
    const currentScoreEl = document.getElementById('current-score');
    const bestScoreEl = document.getElementById('best-score');
    const winRateEl = document.getElementById('win-rate');
    const gamesPlayedEl = document.getElementById('games-played');
    const gamesWonEl = document.getElementById('games-won');
    const currentStreakEl = document.getElementById('current-streak');
    const bestStreakEl = document.getElementById('best-streak');
    const achievementGrid = document.getElementById('achievement-grid');
    
    // New elements
    const averageScoreEl = document.getElementById('average-score');
    const totalXpEl = document.getElementById('total-xp');
    const accuracyRateEl = document.getElementById('accuracy-rate');
    const totalPlaytimeEl = document.getElementById('total-playtime');
    const sessionListEl = document.getElementById('session-list');
    const playerNameEl = document.getElementById('player-name');
    const playerAvatarEl = document.getElementById('player-avatar');
    const rankBadgeEl = document.getElementById('rank-badge');
    const xpFillEl = document.getElementById('xp-fill');
    const xpTextEl = document.getElementById('xp-text');
    
    // Sounds
    const sndSeq = document.getElementById('snd-seq');
    const sndClick = document.getElementById('snd-click');
    const sndWin = document.getElementById('snd-win');
    const sndLose = document.getElementById('snd-lose');
    const sndAchievement = document.getElementById('snd-achievement');
    const sndScore = document.getElementById('snd-score');
    const sndLevelComplete = document.getElementById('snd-level-complete');
    const sndCorrect = document.getElementById('snd-correct');
    const sndWrong = document.getElementById('snd-wrong');

    // Helper function to play sound safely
    function playSound(audio) {
      try {
        audio.currentTime = 0;
        audio.volume = 0.3;
        const playPromise = audio.play();
        if (playPromise !== undefined) {
          playPromise.catch(e => {
            console.log('Audio play failed:', e);
            document.addEventListener('click', enableAudio, { once: true });
          });
        }
      } catch (e) {
        console.log('Audio error:', e);
      }
    }
    
    // Enable audio on first user interaction
    let audioEnabled = false;
    function enableAudio() {
      if (!audioEnabled) {
        audioEnabled = true;
        [sndSeq, sndClick, sndWin, sndLose, sndAchievement, sndScore, sndLevelComplete, sndCorrect, sndWrong].forEach(audio => {
          audio.volume = 0.3;
          audio.load();
        });
      }
    }
    
    document.addEventListener('click', enableAudio, { once: true });
    document.addEventListener('touchstart', enableAudio, { once: true });

    let pattern = [];
    let userStep = 0;
    let playing = false;
    let level = 0;
    let winFlag = false;
    let gameStartTime = 0;
    let currentSessionErrors = [];
    
    // Enhanced Game Statistics with persistent storage
    let gameStats = {
      currentScore: 0,
      bestScore: 0,
      gamesPlayed: 0,
      gamesWon: 0,
      currentStreak: 0,
      bestStreak: 0,
      totalXP: 0,
      currentXP: 0,
      rank: 'bronze',
      playerName: 'EthOS Player',
      playerAvatar: '🎮',
      achievements: new Set(),
      sessions: [],
      buttonErrors: [0, 0, 0, 0],
      totalPlayTime: 0,
      totalInputs: 0,
      correctInputs: 0,
      performanceHistory: []
    };
    
    // Rank System
    const ranks = {
      bronze: { name: 'Bronze', xpRequired: 0, color: 'bronze' },
      silver: { name: 'Silver', xpRequired: 500, color: 'silver' },
      gold: { name: 'Gold', xpRequired: 1500, color: 'gold' },
      diamond: { name: 'Diamond', xpRequired: 3000, color: 'diamond' },
      master: { name: 'Master', xpRequired: 6000, color: 'master' }
    };
    
    // Enhanced Achievement Definitions with tiers
    const achievements = {
      'first_win': { 
        icon: '🎯', 
        name: 'First Victory', 
        description: 'Complete your first game',
        tier: 'bronze',
        xpReward: 50
      },
      'speed_demon': { 
        icon: '⚡', 
        name: 'Speed Demon', 
        description: 'Complete game in under 60 seconds',
        tier: 'silver',
        xpReward: 100
      },
      'perfectionist': { 
        icon: '💎', 
        name: 'Perfectionist', 
        description: 'Win 3 games in a row',
        tier: 'silver',
        xpReward: 150
      },
      'level_5': { 
        icon: '🥉', 
        name: 'Level 5 Master', 
        description: 'Reach level 5',
        tier: 'bronze',
        xpReward: 75
      },
      'level_8': { 
        icon: '🥈', 
        name: 'Level 8 Expert', 
        description: 'Reach level 8',
        tier: 'silver',
        xpReward: 125
      },
      'level_10': { 
        icon: '🥇', 
        name: 'Perfect Game', 
        description: 'Complete all 10 levels',
        tier: 'gold',
        xpReward: 200
      },
      'high_scorer': { 
        icon: '⭐', 
        name: 'High Scorer', 
        description: 'Score over 5000 points',
        tier: 'silver',
        xpReward: 100
      },
      'master_scorer': { 
        icon: '🌟', 
        name: 'Score Master', 
        description: 'Score over 10000 points',
        tier: 'gold',
        xpReward: 200
      },
      'win_10': { 
        icon: '👑', 
        name: 'Champion', 
        description: 'Win 10 games total',
        tier: 'silver',
        xpReward: 150
      },
      'win_25': { 
        icon: '🏆', 
        name: 'EthOS Master', 
        description: 'Win 25 games total',
        tier: 'gold',
        xpReward: 250
      },
      'streak_5': { 
        icon: '🔥', 
        name: 'Streak King', 
        description: 'Get 5 win streak',
        tier: 'silver',
        xpReward: 125
      },
      'streak_10': { 
        icon: '🌋', 
        name: 'Unstoppable', 
        description: 'Get 10 win streak',
        tier: 'gold',
        xpReward: 300
      },
      'dedicated': { 
        icon: '💪', 
        name: 'Dedicated Player', 
        description: 'Play 25+ games',
        tier: 'bronze',
        xpReward: 100
      },
      'marathon': { 
        icon: '🏃', 
        name: 'Marathon Runner', 
        description: 'Play 50+ games',
        tier: 'silver',
        xpReward: 200
      },
      'accuracy_master': { 
        icon: '🎯', 
        name: 'Accuracy Master', 
        description: 'Maintain 90%+ accuracy',
        tier: 'gold',
        xpReward: 250
      }
    };
    
    // Persistent Storage using IndexedDB
    class GameStorage {
      constructor() {
        this.dbName = 'EthOSMemoryGame';
        this.version = 1;
        this.db = null;
      }
      
      async init() {
        return new Promise((resolve, reject) => {
          const request = indexedDB.open(this.dbName, this.version);
          
          request.onerror = () => reject(request.error);
          request.onsuccess = () => {
            this.db = request.result;
            resolve();
          };
          
          request.onupgradeneeded = (event) => {
            const db = event.target.result;
            if (!db.objectStoreNames.contains('gameData')) {
              db.createObjectStore('gameData', { keyPath: 'key' });
            }
          };
        });
      }
      
      async save(key, data) {
        return new Promise((resolve, reject) => {
          const transaction = this.db.transaction(['gameData'], 'readwrite');
          const store = transaction.objectStore('gameData');
          const request = store.put({ key, data });
          
          request.onerror = () => reject(request.error);
          request.onsuccess = () => resolve();
        });
      }
      
      async load(key) {
        return new Promise((resolve, reject) => {
          const transaction = this.db.transaction(['gameData'], 'readonly');
          const store = transaction.objectStore('gameData');
          const request = store.get(key);
          
          request.onerror = () => reject(request.error);
          request.onsuccess = () => {
            if (request.result) {
              resolve(request.result.data);
            } else {
              resolve(null);
            }
          };
        });
      }
    }
    
    const storage = new GameStorage();
    
    // Initialize storage and load data
    async function initGame() {
      try {
        await storage.init();
        const savedData = await storage.load('gameStats');
        if (savedData) {
          // Merge saved data with current stats
          Object.assign(gameStats, savedData);
          // Convert achievements back to Set
          gameStats.achievements = new Set(savedData.achievements || []);
        }
      } catch (error) {
        console.log('Storage not available, using memory only');
      }
      
      updateDisplays();
      renderButtons();
      setButtonsDisabled(true);
      setControlDisabled(true);
    }
    
    // Save game data
    async function saveGameData() {
      try {
        // Convert Set to Array for storage
        const dataToSave = {
          ...gameStats,
          achievements: Array.from(gameStats.achievements)
        };
        await storage.save('gameStats', dataToSave);
      } catch (error) {
        console.log('Failed to save data');
      }
    }
    
    // Tab switching functionality
    function switchTab(tabName) {
      // Hide all tabs
      document.querySelectorAll('.tab-content').forEach(tab => {
        tab.classList.remove('active');
      });
      
      // Remove active from all buttons
      document.querySelectorAll('.tab-btn').forEach(btn => {
        btn.classList.remove('active');
      });
      
      // Show selected tab
      document.getElementById(tabName + '-tab').classList.add('active');
      
      // Mark button as active
      event.target.classList.add('active');
      
      // Update displays when switching to stats
      if (tabName === 'stats') {
        updatePerformanceChart();
        updateButtonHeatmap();
        updateSessionHistory();
      }
    }
    
    // Profile functions
    function updatePlayerName() {
      const nameInput = document.getElementById('name-input');
      gameStats.playerName = nameInput.value || 'EthOS Player';
      playerNameEl.textContent = gameStats.playerName;
      saveGameData();
    }
    
    function setAvatar(emoji) {
      gameStats.playerAvatar = emoji;
      playerAvatarEl.textContent = emoji;
      saveGameData();
    }
    
    function changeAvatar() {
      const avatars = ['🎮', '👾', '🤖', '🚀', '⚡', '🔥', '💎', '🌟', '🏆', '👑'];
      const currentIndex = avatars.indexOf(gameStats.playerAvatar);
      const nextIndex = (currentIndex + 1) % avatars.length;
      setAvatar(avatars[nextIndex]);
    }
    
    function resetAllData() {
      if (confirm('Are you sure you want to reset all game data? This cannot be undone!')) {
        gameStats = {
          currentScore: 0,
          bestScore: 0,
          gamesPlayed: 0,
          gamesWon: 0,
          currentStreak: 0,
          bestStreak: 0,
          totalXP: 0,
          currentXP: 0,
          rank: 'bronze',
          playerName: 'EthOS Player',
          playerAvatar: '🎮',
          achievements: new Set(),
          sessions: [],
          buttonErrors: [0, 0, 0, 0],
          totalPlayTime: 0,
          totalInputs: 0,
          correctInputs: 0,
          performanceHistory: []
        };
        
        document.getElementById('name-input').value = 'EthOS Player';
        saveGameData();
        updateDisplays();
        alert('All data has been reset!');
      }
    }
    
    // XP and Rank System
    function addXP(amount) {
      gameStats.totalXP += amount;
      gameStats.currentXP += amount;
      
      // Check for rank up
      const currentRankData = ranks[gameStats.rank];
      const rankKeys = Object.keys(ranks);
      const currentRankIndex = rankKeys.indexOf(gameStats.rank);
      
      if (currentRankIndex < rankKeys.length - 1) {
        const nextRank = rankKeys[currentRankIndex + 1];
        const nextRankData = ranks[nextRank];
        
        if (gameStats.totalXP >= nextRankData.xpRequired) {
          gameStats.rank = nextRank;
          gameStats.currentXP = gameStats.totalXP - nextRankData.xpRequired;
          
          // Show rank up notification
          showPopup('achievement', '🎉 Rank Up!', 
            `Congratulations! You've reached ${nextRankData.name} rank!`);
          playSound(sndAchievement);
        }
      }
      
      updateRankDisplay();
    }
    
    function updateRankDisplay() {
      const currentRankData = ranks[gameStats.rank];
      const rankKeys = Object.keys(ranks);
      const currentRankIndex = rankKeys.indexOf(gameStats.rank);
      
      rankBadgeEl.textContent = currentRankData.name;
      rankBadgeEl.className = `rank-badge ${gameStats.rank}`;
      
      if (currentRankIndex < rankKeys.length - 1) {
        const nextRank = rankKeys[currentRankIndex + 1];
        const nextRankData = ranks[nextRank];
        const xpNeeded = nextRankData.xpRequired - gameStats.totalXP;
        const xpProgress = gameStats.totalXP - currentRankData.xpRequired;
        const xpRange = nextRankData.xpRequired - currentRankData.xpRequired;
        const percentage = Math.max(0, Math.min(100, (xpProgress / xpRange) * 100));
        
        xpFillEl.style.width = percentage + '%';
        xpTextEl.textContent = `${xpProgress} / ${xpRange} XP to ${nextRankData.name}`;
      } else {
        xpFillEl.style.width = '100%';
        xpTextEl.textContent = 'Maximum Rank Achieved!';
      }
    }
    
    // Performance tracking
    function updatePerformanceChart() {
      const canvas = document.getElementById('performance-canvas');
      const ctx = canvas.getContext('2d');
      
      // Clear canvas
      ctx.clearRect(0, 0, canvas.width, canvas.height);
      
      if (gameStats.performanceHistory.length < 2) {
        ctx.fillStyle = 'rgba(255, 255, 255, 0.5)';
        ctx.font = '16px Arial';
        ctx.textAlign = 'center';
        ctx.fillText('Play more games to see performance chart', canvas.width / 2, canvas.height / 2);
        return;
      }
      
      const data = gameStats.performanceHistory.slice(-20); // Last 20 games
      const maxScore = Math.max(...data.map(d => d.score), 1000);
      const padding = 40;
      const chartWidth = canvas.width - padding * 2;
      const chartHeight = canvas.height - padding * 2;
      
      // Draw grid lines
      ctx.strokeStyle = 'rgba(255, 255, 255, 0.2)';
      ctx.lineWidth = 1;
      
      // Horizontal grid lines
      for (let i = 0; i <= 5; i++) {
        const y = padding + (chartHeight / 5) * i;
        ctx.beginPath();
        ctx.moveTo(padding, y);
        ctx.lineTo(canvas.width - padding, y);
        ctx.stroke();
        
        // Y-axis labels
        ctx.fillStyle = 'rgba(255, 255, 255, 0.7)';
        ctx.font = '12px Arial';
        ctx.textAlign = 'right';
        ctx.fillText(Math.round(maxScore - (maxScore / 5) * i), padding - 5, y + 4);
      }
      
      // Draw performance line
      ctx.strokeStyle = '#00ff88';
      ctx.lineWidth = 3;
      ctx.beginPath();
      
      data.forEach((point, index) => {
        const x = padding + (chartWidth / (data.length - 1)) * index;
        const y = padding + chartHeight - (point.score / maxScore) * chartHeight;
        
        if (index === 0) {
          ctx.moveTo(x, y);
        } else {
          ctx.lineTo(x, y);
        }
      });
      
      ctx.stroke();
      
      // Draw points
      ctx.fillStyle = '#00ff88';
      data.forEach((point, index) => {
        const x = padding + (chartWidth / (data.length - 1)) * index;
        const y = padding + chartHeight - (point.score / maxScore) * chartHeight;
        
        ctx.beginPath();
        ctx.arc(x, y, 4, 0, 2 * Math.PI);
        ctx.fill();
      });
    }
    
    function updateButtonHeatmap() {
      const maxErrors = Math.max(...gameStats.buttonErrors, 1);
      
      gameStats.buttonErrors.forEach((errorCount, index) => {
        const button = document.getElementById(`heatmap-${index}`);
        const countEl = button.querySelector('.heatmap-count');
        countEl.textContent = errorCount;
        
        // Update color based on error count
        button.classList.remove('low', 'medium', 'high');
        
        const percentage = errorCount / maxErrors;
        if (percentage < 0.3) {
          button.classList.add('low');
        } else if (percentage < 0.7) {
          button.classList.add('medium');
        } else {
          button.classList.add('high');
        }
      });
    }
    
    function updateSessionHistory() {
      sessionListEl.innerHTML = '';
      
      if (gameStats.sessions.length === 0) {
        sessionListEl.innerHTML = '<div style="text-align: center; opacity: 0.6; padding: 20px;">No sessions recorded yet</div>';
        return;
      }
      
      const recentSessions = gameStats.sessions.slice(-10).reverse(); // Last 10 sessions, newest first
      
      recentSessions.forEach(session => {
        const sessionDiv = document.createElement('div');
        sessionDiv.className = 'session-item';
        
        const date = new Date(session.timestamp);
        const timeStr = date.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });
        const dateStr = date.toLocaleDateString();
        
        sessionDiv.innerHTML = `
          <div class="session-info">
            <div class="session-score">${session.score.toLocaleString()} points</div>
            <div class="session-details">
              Level ${session.level} • ${session.won ? 'Won' : 'Lost'} • ${Math.round(session.duration / 1000)}s
            </div>
          </div>
          <div class="session-time">
            ${timeStr}<br>
            <small>${dateStr}</small>
          </div>
        `;
        
        sessionListEl.appendChild(sessionDiv);
      });
    }
    
    // Initialize achievements display
    function initAchievements() {
      achievementGrid.innerHTML = '';
      Object.entries(achievements).forEach(([key, achievement]) => {
        const item = document.createElement('div');
        item.className = `achievement-item ${gameStats.achievements.has(key) ? 'unlocked' : 'locked'} ${achievement.tier}`;
        item.innerHTML = `
          ${achievement.icon}
          <div class="achievement-tier">${achievement.tier.toUpperCase()}</div>
          <div class="achievement-tooltip">
            ${achievement.name}<br>
            ${achievement.description}<br>
            <small>+${achievement.xpReward} XP</small>
          </div>
        `;
        achievementGrid.appendChild(item);
      });
    }
    
    // Update displays
    function updateDisplays() {
      currentScoreEl.textContent = gameStats.currentScore.toLocaleString();
      bestScoreEl.textContent = gameStats.bestScore.toLocaleString();
      gamesPlayedEl.textContent = gameStats.gamesPlayed;
      gamesWonEl.textContent = gameStats.gamesWon;
      currentStreakEl.textContent = gameStats.currentStreak;
      bestStreakEl.textContent = gameStats.bestStreak;
      
      // New stats
      const avgScore = gameStats.gamesPlayed > 0 ? 
        Math.round(gameStats.sessions.reduce((sum, s) => sum + s.score, 0) / gameStats.gamesPlayed) : 0;
      averageScoreEl.textContent = avgScore.toLocaleString();
      
      totalXpEl.textContent = gameStats.totalXP.toLocaleString();
      
      const accuracy = gameStats.totalInputs > 0 ? 
        Math.round((gameStats.correctInputs / gameStats.totalInputs) * 100) : 0;
      accuracyRateEl.textContent = accuracy + '%';
      
      const playTimeMinutes = Math.round(gameStats.totalPlayTime / 60000);
      totalPlaytimeEl.textContent = playTimeMinutes + 'm';
      
      const winRate = gameStats.gamesPlayed > 0 ? 
        Math.round((gameStats.gamesWon / gameStats.gamesPlayed) * 100) : 0;
      winRateEl.textContent = winRate + '%';
      
      // Update profile
      playerNameEl.textContent = gameStats.playerName;
      playerAvatarEl.textContent = gameStats.playerAvatar;
      
      updateRankDisplay();
      initAchievements();
    }
    
    // Unlock achievement
    function unlockAchievement(key) {
      if (!gameStats.achievements.has(key)) {
        gameStats.achievements.add(key);
        const achievement = achievements[key];
        
        // Add XP reward
        addXP(achievement.xpReward);
        
        // Play achievement sound
        playSound(sndAchievement);
        
        showPopup('achievement', '🏆 Achievement Unlocked!', 
          `${achievement.icon} ${achievement.name}<br><small>${achievement.description}</small><br><strong>+${achievement.xpReward} XP</strong>`);
        updateDisplays();
        saveGameData();
      }
    }
    
    // Check achievements
    function checkAchievements() {
      // Level-based achievements
      if (level >= 5) unlockAchievement('level_5');
      if (level >= 8) unlockAchievement('level_8');
      if (level >= 10) unlockAchievement('level_10');
      
      // Win-based achievements
      if (gameStats.gamesWon >= 1) unlockAchievement('first_win');
      if (gameStats.gamesWon >= 10) unlockAchievement('win_10');
      if (gameStats.gamesWon >= 25) unlockAchievement('win_25');
      
      // Streak achievements
      if (gameStats.currentStreak >= 3) unlockAchievement('perfectionist');
      if (gameStats.currentStreak >= 5) unlockAchievement('streak_5');
      if (gameStats.currentStreak >= 10) unlockAchievement('streak_10');
      
      // Score achievements
      if (gameStats.bestScore >= 5000) unlockAchievement('high_scorer');
      if (gameStats.bestScore >= 10000) unlockAchievement('master_scorer');
      
      // Play count achievements
      if (gameStats.gamesPlayed >= 25) unlockAchievement('dedicated');
      if (gameStats.gamesPlayed >= 50) unlockAchievement('marathon');
      
      // Accuracy achievement
      const accuracy = gameStats.totalInputs > 0 ? 
        (gameStats.correctInputs / gameStats.totalInputs) * 100 : 0;
      if (accuracy >= 90 && gameStats.gamesPlayed >= 10) {
        unlockAchievement('accuracy_master');
      }
    }
    
    // Calculate score
    function calculateScore(level, timeBonus, perfect = false) {
      let baseScore = level * 500;
      let streakBonus = gameStats.currentStreak * 100;
      let perfectBonus = perfect ? 1000 : 0;
      return baseScore + timeBonus + streakBonus + perfectBonus;
    }
    
    // Show popup function
    function showPopup(type, title, message, callback) {
      const overlay = document.createElement('div');
      overlay.className = 'popup-overlay';
      overlay.innerHTML = `
        <div class="popup ${type}">
          <h2>${title}</h2>
          <p>${message}</p>
          <button class="popup-btn" onclick="closePopup()">OK</button>
        </div>
      `;
      document.body.appendChild(overlay);
      
      // Store callback for later use
      window.popupCallback = callback;
      
      // Auto close after 3 seconds for success and achievement
      if (type === 'success' || type === 'achievement') {
        setTimeout(() => {
          closePopup();
        }, 3000);
      }
    }
    
    // Close popup function
    function closePopup() {
      const overlay = document.querySelector('.popup-overlay');
      if (overlay) {
        overlay.remove();
        if (window.popupCallback) {
          window.popupCallback();
          window.popupCallback = null;
        }
      }
    }
    
    window.closePopup = closePopup;

    // Random code generator (A-Z, 0-9, 8 chars)
    function generateCode(length=8) {
      const chars = "ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";
      let code = "";
      for(let i=0; i<length; i++) {
        code += chars[Math.floor(Math.random()*chars.length)];
      }
      return code;
    }

    // Render 4 logo buttons
    function renderButtons() {
      gameContainer.innerHTML = '';
      for (let i = 0; i < buttonCount; i++) {
        const btn = document.createElement('button');
        btn.className = `logo-btn color${i}`;
        
        const img = document.createElement('img');
        img.src = logoSrc;
        img.alt = "EthOS Logo";
        img.crossOrigin = "anonymous";
        
        // Add error handling for image loading
        img.onerror = function() {
          this.style.display = 'none';
          btn.innerHTML = `<div style="display: flex; align-items: center; justify-content: center; height: 100%; font-size: 2em; color: #fff;">◆</div>`;
        };
        
        btn.appendChild(img);
        btn.onclick = () => handleUserInput(i);
        btn.disabled = true;
        gameContainer.appendChild(btn);
      }
    }

    function setButtonsDisabled(disabled = true) {
      const btns = document.querySelectorAll('.logo-btn');
      btns.forEach(btn => btn.disabled = disabled);
    }

    function setControlDisabled(disabled) {
      restartBtn.disabled = disabled;
      startOverBtn.disabled = disabled;
    }

    function nextLevel() {
      level++;
      userStep = 0;
      pattern.push(Math.floor(Math.random() * buttonCount));
      showPattern();
    }

    function showPattern() {
      setButtonsDisabled(true);
      setControlDisabled(true);
      let idx = 0;
      const btns = document.querySelectorAll('.logo-btn');
      
      statusDiv.innerHTML = `<div class="level-indicator">Level ${level} / ${maxLevel}</div><div>Watch the sequence carefully! 👀</div>`;
      
      function highlight() {
        if (idx > 0) btns[pattern[idx - 1]].classList.remove('active');
        if (idx < pattern.length) {
          btns[pattern[idx]].classList.add('active');
          playSound(sndSeq);
          setTimeout(() => {
            idx++;
            highlight();
          }, 700);
        } else {
          btns.forEach(btn => btn.classList.remove('active'));
          setTimeout(() => {
            setButtonsDisabled(false);
            setControlDisabled(false);
            statusDiv.innerHTML = `<div class="level-indicator">Level ${level} / ${maxLevel}</div><div>Your turn! Click the sequence 🎯</div>`;
          }, 200);
        }
      }
      setTimeout(highlight, 500);
    }

    function handleUserInput(i) {
      if (!playing) return;
      const btns = document.querySelectorAll('.logo-btn');
      
      // Track input for statistics
      gameStats.totalInputs++;
      
      // Animation and sound
      btns[i].classList.add('active');
      playSound(sndClick);
      setTimeout(() => btns[i].classList.remove('active'), 250);

      if (i === pattern[userStep]) {
        // Correct input
        gameStats.correctInputs++;
        btns[i].classList.add('correct');
        playSound(sndCorrect);
        setTimeout(() => btns[i].classList.remove('correct'), 500);
        
        userStep++;
        if (userStep === pattern.length) {
          setButtonsDisabled(true);
          
          // Calculate level score
          const timeElapsed = Date.now() - gameStartTime;
          const timeBonus = Math.max(0, 2000 - (timeElapsed / level));
          const levelScore = calculateScore(1, timeBonus);
          gameStats.currentScore += levelScore;
          
          // Add XP for completing level
          addXP(level * 10);
          
          // Play score sound
          playSound(sndScore);
          
          if (level === maxLevel) {
            // WIN GAME!
            playing = false;
            winFlag = true;
            gameStats.gamesWon++;
            gameStats.currentStreak++;
            
            if (gameStats.currentStreak > gameStats.bestStreak) {
              gameStats.bestStreak = gameStats.currentStreak;
            }
            
            if (gameStats.currentScore > gameStats.bestScore) {
              gameStats.bestScore = gameStats.currentScore;
            }
            
            // Record session
            const sessionDuration = Date.now() - gameStartTime;
            gameStats.totalPlayTime += sessionDuration;
            
            const session = {
              timestamp: Date.now(),
              score: gameStats.currentScore,
              level: level,
              won: true,
              duration: sessionDuration,
              errors: currentSessionErrors.length
            };
            
            gameStats.sessions.push(session);
            gameStats.performanceHistory.push({
              score: gameStats.currentScore,
              timestamp: Date.now()
            });
            
            // Check for speed demon achievement
            if (sessionDuration < 60000) {
              unlockAchievement('speed_demon');
            }
            
            // Add bonus XP for winning
            addXP(200);
            
            checkAchievements();
            updateDisplays();
            saveGameData();
            playSound(sndWin);
            showWin();
          } else {
            // Play level complete sound
            playSound(sndLevelComplete);
            
            setTimeout(() => {
              statusDiv.innerHTML = `
                <div class="level-indicator">Level ${level} Complete! ✨</div>
                <div>Score: +${levelScore.toLocaleString()}</div>
                <div>Get ready for the next level...</div>
              `;
              updateDisplays();
              setTimeout(nextLevel, 1500);
            }, 400);
          }
        }
      } else {
        // Wrong input
        gameStats.buttonErrors[i]++;
        currentSessionErrors.push({ button: i, level: level });
        
        btns[i].classList.add('wrong');
        playSound(sndWrong);
        setTimeout(() => btns[i].classList.remove('wrong'), 500);
        
        playing = false;
        gameStats.currentStreak = 0; // Reset streak
        setButtonsDisabled(true);
        setControlDisabled(false);
        playSound(sndLose);
        
        // Record failed session
        const sessionDuration = Date.now() - gameStartTime;
        gameStats.totalPlayTime += sessionDuration;
        
        const session = {
          timestamp: Date.now(),
          score: gameStats.currentScore,
          level: level,
          won: false,
          duration: sessionDuration,
          errors: currentSessionErrors.length
        };
        
        gameStats.sessions.push(session);
        gameStats.performanceHistory.push({
          score: gameStats.currentScore,
          timestamp: Date.now()
        });
        
        checkAchievements();
        updateDisplays();
        saveGameData();
        
        // Show failure popup
        showPopup('failure', 'FAILED', 'NO CODE FOR YOU!', () => {
          statusDiv.innerHTML = `
            <div style="color: #ff6b6b; font-size: 1.3em; margin-bottom: 10px;">🎮 Game Over!</div>
            <div class="level-indicator">Reached Level: ${level} | Score: ${gameStats.currentScore.toLocaleString()}</div>
            <div style="margin-top: 15px;">Try again to unlock your EthOS code! 💪</div>
          `;
          startBtn.disabled = false;
          codeBox.style.display = "none";
          updateDisplays();
        });
      }
    }

    function showWin() {
      const code = generateCode();
      
      // Show success popup
      showPopup('success', 'CONGRATS', `YOU GOT A CODE!<br><small>Final Score: ${gameStats.currentScore.toLocaleString()}</small>`, () => {
        statusDiv.innerHTML = `
          <div style="color: #00ff88; font-size: 1.4em; margin-bottom: 15px;">🏆 VICTORY! 🏆</div>
          <div>Perfect completion of all ${maxLevel} levels!</div>
          <div>Final Score: ${gameStats.currentScore.toLocaleString()}</div>
        `;
        codeBox.querySelector('span').textContent = code;
        codeBox.style.display = "block";
        setControlDisabled(false);
        startBtn.disabled = false;
      });
    }

    startBtn.onclick = () => {
      enableAudio();
      playing = true;
      pattern = [];
      level = 0;
      winFlag = false;
      gameStats.currentScore = 0;
      gameStats.gamesPlayed++;
      gameStartTime = Date.now();
      currentSessionErrors = [];
      
      startBtn.disabled = true;
      codeBox.style.display = "none";
      statusDiv.innerHTML = `<div>🎮 Initializing EthOS Memory Challenge...</div>`;
      updateDisplays();
      setTimeout(nextLevel, 1000);
      setControlDisabled(true);
    };

    restartBtn.onclick = () => {
      playing = true;
      level = 0;
      userStep = 0;
      winFlag = false;
      gameStats.currentScore = 0;
      gameStartTime = Date.now();
      currentSessionErrors = [];
      
      startBtn.disabled = true;
      codeBox.style.display = "none";
      statusDiv.innerHTML = `<div>🔄 Restarting current challenge...</div>`;
      updateDisplays();
      setTimeout(nextLevel, 800);
      setControlDisabled(true);
    };

    startOverBtn.onclick = () => {
      playing = true;
      pattern = [];
      level = 0;
      winFlag = false;
      gameStats.currentScore = 0;
      gameStats.gamesPlayed++;
      gameStartTime = Date.now();
      currentSessionErrors = [];
      
      startBtn.disabled = true;
      codeBox.style.display = "none";
      statusDiv.innerHTML = `<div>🆕 Starting fresh EthOS journey...</div>`;
      updateDisplays();
      setTimeout(nextLevel, 1000);
      setControlDisabled(true);
    };

    // Make functions globally available
    window.switchTab = switchTab;
    window.updatePlayerName = updatePlayerName;
    window.setAvatar = setAvatar;
    window.changeAvatar = changeAvatar;
    window.resetAllData = resetAllData;

  // Initialize game
  initGame();
</script>

<!-- Developer Credit Section -->
<div style="
  margin: 30px auto 10px auto;
  padding: 16px 10px 10px 10px;
  max-width: 320px;
  border-radius: 18px;
  background: rgba(255,255,255,0.13);
  color: #fff;
  text-align: center;
  font-size: 1.06em;
  box-shadow: 0 2px 14px rgba(0,0,0,0.11);
  letter-spacing: 0.02em;
">
  Developed with ❤️ by 
  <a 
    href="https://x.com/jueunlogic" 
    target="_blank" 
    style="color: #60a5fa; text-decoration: underline; font-weight: 600; margin-left:3px; margin-right:3px;"
    rel="noopener noreferrer"
  >
    <span style="vertical-align:middle;" aria-label="X / Twitter">🐦</span> @jueunlogic
  </a>
</div>

</body>
</html>
